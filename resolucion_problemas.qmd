---
title: "Problemas de Teoría de la Decisión bajo Incertidumbre (con código)"
format: pdf
editor: visual
---

# Problema 1: Elección de proveedor de café

Una empresa que fabrica cápsulas de café debe decidir entre tres posibles proveedores: **Aroma S.A.**, **Cafés del Sur** y **Tostadores Sevilla**.  
El precio por kilo dependerá de la **cosecha anual**, que puede ser *buena*, *normal* o *mala*.

**Pregunta:**  
Si la empresa no conoce las probabilidades de cada tipo de cosecha, ¿qué proveedor debería elegir para minimizar el riesgo de pagar precios altos?

```{r}
# Tabla de precios
proveedores <- matrix(
  c(8, 9, 13,
    9, 8, 11,
    7, 10, 15),
  nrow = 3, byrow = TRUE
)
colnames(proveedores) <- c("Cosecha buena", "Cosecha normal", "Cosecha mala")
rownames(proveedores) <- c("Aroma S.A.", "Cafés del Sur", "Tostadores Sevilla")

# Mostrar tabla de precios
knitr::kable(proveedores, caption = "Tabla de precios por proveedor (€/kg)")

# Criterio de Laplace (promedio de costes)
media_costes <- rowMeans(proveedores)
knitr::kable(data.frame(Proveedor=rownames(proveedores), Coste_Medio=media_costes),
             caption = "Coste medio según Laplace")

# Decisión recomendada
mejor_proveedor <- names(which.min(media_costes))
mejor_proveedor

```


# Problema 2: Elección de proveedor de energía

Una pequeña cadena de supermercados de Sevilla debe elegir entre tres proveedores de energía:  

- **SolarSur** (solar)  
- **EólicaAndalucía** (eólica)  
- **HidroPower** (hidroeléctrica)  

El beneficio anual estimado (en miles de euros) depende del precio de la energía durante el año: **bajo (e1)**, **medio (e2)**, **alto (e3)**.

```{r}
# Tabla de beneficios
energia <- matrix(
  c(60, 80, 100,
    50, 100, 120,
    70, 90, 110),
  nrow = 3,
  byrow = TRUE
)
colnames(energia) <- c("Bajo", "Medio", "Alto")
rownames(energia) <- c("SolarSur", "EólicaAndalucía", "HidroPower")

# Mostrar tabla
knitr::kable(energia, caption = "Tabla de beneficios por proveedor (miles de euros)")

# Función para calcular todos los criterios de decisión
decision_incertidumbre <- function(tabla, alpha = 0.6) {
  # Maximax
  maximax <- apply(tabla, 1, max)
  
  # Maximin
  maximin <- apply(tabla, 1, min)
  
  # Laplace
  laplace <- rowMeans(tabla)
  
  # Hurwicz
  hurwicz <- alpha * apply(tabla, 1, max) + (1 - alpha) * apply(tabla, 1, min)
  
  # Savage
  mejores <- apply(tabla, 2, max)
  regret <- sweep(mejores, 2, tabla, "-")
  savage <- apply(regret, 1, max)
  
  # Tabla de resultados
  data.frame(
    Decisión = rownames(tabla),
    Maximax = maximax,
    Maximin = maximin,
    Laplace = laplace,
    Hurwicz = hurwicz,
    Savage = savage
  )
}

# Aplicar la función
resultado <- decision_incertidumbre(energia)
knitr::kable(resultado, caption = "Resultados de todos los criterios")

**Conclusión:** La opción más recomendable según la mayoría de criterios es EólicaAndalucía.

